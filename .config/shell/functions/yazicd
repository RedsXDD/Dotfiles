# vim:fileencoding=utf-8:foldmethod=marker:filetype=sh

alias \
	yazi='yazicd' \
	y='yazicd' \
	yi='cdi && yazicd'

yazicd(){
	local exited_path
	local cwd

	exited_path="$(mktemp -t "yazi_cwd.XXXXXXXXXX")"
	STARSHIP_CONFIG="/dev/null" command yazi --cwd-file="$exited_path" "$@"

	if cwd="$(< "$exited_path")" && [ -n "$cwd" ] && [ "$cwd" != "$PWD" ]; then
		builtin cd -- "$cwd" || return 1
	fi

	rm -rf -- "$exited_path" >/dev/null 2>&1
}
