#!/usr/bin/env sh

# Use Generated Menu from DM-Core:
# shellcheck disable=SC1091
menu(){ rofi -i -dmenu "$@"; }
# shellcheck disable=SC1091
lockcmd(){ . "$HOME"/.local/bin/lock; }

set -- \
'üï≥Ô∏è¬ßEsc Menu' \
'‚ôªÔ∏è¬ßReload Hyprland' \
'üñ•Ô∏è¬ßShutdown' \
'üì∫¬ß Suspend' \
'üîÉ¬ß Reboot' \
'üö™¬ß Exit Hyprland' \
'üîí¬ß Lock screen'

# shellcheck disable=SC2183
choice="$(printf '%s\n' "$@" | awk -F '¬ß' '{print $1" "$2}' | menu -p "Power Menu:" | tr '[:upper:]' '[:lower:]')"

if [ -z "$choice" ]; then
 echo 'No Choice Was Made.'; exit 1
else
 [ "$choice" = "Esc Menu" ] && echo 'Exited Menu.' && exit 0
 case "$choice" in
  # ------------------------------------------------------------------------------------------------------- #
  *'reload'*'hyprland') hyprctl reload ;;
  # ------------------------------------------------------------------------------------------------------- #
  *'reboot'*)
   # shellcheck disable=SC2028
   confirm=$(printf 'Yes''%s\n''No' | menu -p "Are You Sure?")
   [ "$confirm" = 'Yes' ] && systemctl reboot || echo 'User Choose to Not Perform an Action.' && exit 1
  ;;
  # ------------------------------------------------------------------------------------------------------- #
  *'shutdown'*)
   # shellcheck disable=SC2028
   confirm=$(printf 'Yes''%s\n''No' | menu -p "Are You Sure?")
   [ "$confirm" = 'Yes' ] && systemctl poweroff || echo 'User Choose to Not Perform an Action.' && exit 1
  ;;
  # ------------------------------------------------------------------------------------------------------- #
  *'suspend'*)
   # shellcheck disable=SC2028
   confirm=$(printf 'Yes''%s\n''No' | menu -p "Are You Sure?")
   [ "$confirm" = 'Yes' ] && systemctl suspend || echo 'User Choose to Not Perform an Action.' && exit 1
  ;;
  # ------------------------------------------------------------------------------------------------------- #
  *'exit hyprland'*)
   # shellcheck disable=SC2028
   confirm=$(printf 'Yes''%s\n''No' | menu -p "Are You Sure?")
   [ "$confirm" = 'Yes' ] && killall Hyprland || echo 'User Choose to Not Perform an Action.' && exit 1
  ;;
  # ------------------------------------------------------------------------------------------------------- #
  *'lock screen'*) lockcmd ;;
  # ------------------------------------------------------------------------------------------------------- #
  *) echo 'Program Terminated.' && exit 1 ;;
 esac
fi
