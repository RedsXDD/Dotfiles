#!/usr/bin/env sh
base_url='duckduckgo.com'
base_browser='surf'
xidfile='/tmp/browtab.xid'

#mainbrave
#mainwolf
#mainvimb
#mainfox
#mainqute

# Invalid Options:
invalid()
{
 cat << EOFi
 bbb
 bbb
 bbb
EOFi
}

# Help Page:
help()
{
 cat << EOFh
 aaaa
 aaaa
 aaaa
EOFh
}

# Main Function for The Surf Browser:
mainsurf()
{
 # Basic Arguments:
 xid="$(cat "$xidfile")"
 xcheck="$(xprop -id "$xid" 2>/dev/null)"

 # Check if There is an Already Running Instance of BrowTab,
 # If None Exists Create a New One:
 if [ -z "$xcheck" ]; then
  tabbed -dc -r 2 surf -e '' "$base_url" >"$xidfile" 2>/dev/null &
  sleep 0.2
  xid="$(cat "$xidfile")"
  surf_id="$(xdotool search --class surf | sort -h | tail -n1)"
  surf -e "$xid" "$url" >/dev/null 2>&1 &
  sleep 0.3
  xdotool windowkill "$surf_id"
 # If Theres One, Embend Surf into It:
 else
  surf -e "$xid" "$url" >/dev/null 2>&1 &
 fi
}

case "$1" in
 '-b'|'--browser')
  browser="$2"
  [ -z "$browser" ] && browser="base_browser"
  case "$browser" in
   [Bb]'rave') mainbrave ;;
   [Ll]'ibre'[Ww]'olf') mainwolf ;;
   [Vv]'imb') mainvimb ;;
   [Ss]'urf') mainsurf ;;
   [Ff]'irefox') mainfox ;;
   [Qq]'ute'[Bb]'rowser') mainqute ;;
  esac
 ;;
 '-u'|'--url') url="$2"; [ -z "$url" ] && url="$base_url"; mainsurf ;;
 '-h'|'--help') help ;;
 *) invalid && exit 1 ;;
esac

