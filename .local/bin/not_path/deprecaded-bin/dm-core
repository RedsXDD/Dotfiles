#!/usr/bin/env sh

# Basic Arguments:
# shellcheck disable=SC2016
scripts_path="$HOME/.config/dmenu-rofi"
menu_dir="$HOME/.cache/dm-core"
base_dir="$HOME/.config/base"
global_menu='1'

# Default Programs:
terminal='alacritty'
editor='nvim'
lock='betterlockscreen -l blur 0.5'

# ---------------------------------------------------------------------------------------------------------------------- #

# Generate Files & Options:
gen()
{
 # Generate Menu:
 [ -n "$uniq_menu" ] && global_menu="$uniq_menu"
 case "$global_menu" in
  '1') menu="rofi -dmenu -i -no-show-icons" ;;
 esac

 # Rm Old Files & Recreate Directory:
 \mkdir -pv "${menu_dir}"

 # Generate Menu Script:
 echo '#!/usr/bin/env sh' > "${menu_dir}"/menu
 if [ -n "$pywal_dependent" ]; then
  echo 'if [ -f $HOME/.cache/wal/colors.sh ]; then' >> "${menu_dir}"/menu
   echo "$menu"' "$@"' >> "${menu_dir}"/menu
  echo 'else' >> "${menu_dir}"/menu
   echo "dmenu -i"' "$@"' >> "${menu_dir}"/menu
  echo 'fi' >> "${menu_dir}"/menu
 else
  echo "$menu"' "$@"' >> "${menu_dir}"/menu
 fi
 chmod +x "${menu_dir}"/menu

 # Generate Editor Script:
 echo '#!/usr/bin/env sh' > "${menu_dir}"/editor
 echo "$terminal"' -e '"$editor"' "$@"' >> "${menu_dir}"/editor
 chmod +x "${menu_dir}"/editor

 # Generate Lock Script:
 echo '#!/usr/bin/env sh' > "${menu_dir}"/lock
 echo "$lock" >> "${menu_dir}"/lock
 chmod +x "${menu_dir}"/lock
}

# ---------------------------------------------------------------------------------------------------------------------- #

# Execute Main Scripts:
case "$1" in
 # ********************************************************************* #
 # Edit Configs:
 '1')
  # Generate Specific Menu Prompt:
  uniq_menu=''

  # Generate Needed Files & Run Script:
  # shellcheck disable=SC1091
  gen && echo "${base_dir}"/edit-configs > "${menu_dir}"/base_file && . "$scripts_path/edit-configs"
 ;;
 # ********************************************************************* #
 # Url Bookmarks:
 '2')
  # Generate Specific Menu Prompt:
  uniq_menu=''

  # Generate Needed Files & Run Script:
  # shellcheck disable=SC1091
  gen && echo "${base_dir}"/url-bookmarks > "${menu_dir}"/base_file && . "$scripts_path/url-bookmarks"
 ;;
 # ********************************************************************* #
 # Color Theme Changer:
 '9')
  # Generate Specific Menu Prompt:
  uniq_menu=''

  # Generate Needed Files & Run Script:
  # shellcheck disable=SC1091
  gen && . "$scripts_path/theme-changer"
 ;;
 # ********************************************************************* #
 # Calculator
 '10')
  theme="$HOME/.config/rofi/themes/calc.rasi"
  rofi -show calc --no-icons -theme "$theme" && exit ;;
 # ********************************************************************* #
 # Emoji Selector:
'11') rofi -show emoji -no-show-icons && exit ;;
 # ********************************************************************* # &
 # Power Menu:
 '12')
  # Generate Specific Menu Prompt:
  uniq_menu=''

  # Generate Needed Files & Run Script:
  # shellcheck disable=SC1091
  gen && . "$scripts_path/power-menu"
 ;;
 # ********************************************************************* #
 *) echo 'Program Terminated.' && exit 1 ;;
esac
